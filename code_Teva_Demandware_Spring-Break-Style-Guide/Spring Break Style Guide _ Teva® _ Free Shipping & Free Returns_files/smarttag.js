
var JSON;JSON||(JSON={}),function(){"use strict";function f(a){return 10>a?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(a)),"function"==typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;f>c;c+=1)g[c]=str(c,i)||"null";return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(rep&&"object"==typeof rep)for(f=rep.length,c=0;f>c;c+=1)"string"==typeof rep[c]&&(d=rep[c],e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b"," ":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(a,b,c){var d;if(gap="",indent="","number"==typeof c)for(d=0;c>d;d+=1)indent+=" ";else"string"==typeof c&&(indent=c);if(rep=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw new Error("JSON.stringify");return str("",{"":a})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(){"use strict";function a(){var a=!1;if("localStorage"in window)try{window.localStorage.setItem("_tmptest","tmpval"),a=!0,window.localStorage.removeItem("_tmptest")}catch(b){}if(a)try{window.localStorage&&(v=window.localStorage,y="localStorage",B=v.jStorage_update)}catch(e){}else if("globalStorage"in window)try{window.globalStorage&&(v="localhost"==window.location.hostname?window.globalStorage["localhost.localdomain"]:window.globalStorage[window.location.hostname],y="globalStorage",B=v.jStorage_update)}catch(f){}else{if(w=document.createElement("link"),!w.addBehavior)return void(w=null);w.style.behavior="url(#default#userData)",document.getElementsByTagName("head")[0].appendChild(w);try{w.load("jStorage")}catch(g){w.setAttribute("jStorage","{}"),w.save("jStorage"),w.load("jStorage")}var i="{}";try{i=w.getAttribute("jStorage")}catch(j){}try{B=w.getAttribute("jStorage_update")}catch(m){}v.jStorage=i,y="userDataBehavior"}h(),k(),c(),l(),"addEventListener"in window&&window.addEventListener("pageshow",function(a){a.persisted&&d()},!1)}function b(){var a="{}";if("userDataBehavior"==y){w.load("jStorage");try{a=w.getAttribute("jStorage")}catch(b){}try{B=w.getAttribute("jStorage_update")}catch(c){}v.jStorage=a}h(),k(),l()}function c(){"localStorage"==y||"globalStorage"==y?"addEventListener"in window?window.addEventListener("storage",d,!1):document.attachEvent("onstorage",d):"userDataBehavior"==y&&setInterval(d,1e3)}function d(){var a;clearTimeout(A),A=setTimeout(function(){if("localStorage"==y||"globalStorage"==y)a=v.jStorage_update;else if("userDataBehavior"==y){w.load("jStorage");try{a=w.getAttribute("jStorage_update")}catch(b){}}a&&a!=B&&(B=a,e())},25)}function e(){var a,c=s.parse(s.stringify(u.__jstorage_meta.CRC32));b(),a=s.parse(s.stringify(u.__jstorage_meta.CRC32));var d,e=[],g=[];for(d in c)if(c.hasOwnProperty(d)){if(!a[d]){g.push(d);continue}c[d]!=a[d]&&"2."==String(c[d]).substr(0,2)&&e.push(d)}for(d in a)a.hasOwnProperty(d)&&(c[d]||e.push(d));f(e,"updated"),f(g,"deleted")}function f(a,b){a=[].concat(a||[]);var c,d,e,f;if("flushed"==b){a=[];for(var g in z)z.hasOwnProperty(g)&&a.push(g);b="deleted"}for(c=0,e=a.length;e>c;c++){if(z[a[c]])for(d=0,f=z[a[c]].length;f>d;d++)z[a[c]][d](a[c],b);if(z["*"])for(d=0,f=z["*"].length;f>d;d++)z["*"][d](a[c],b)}}function g(){var a=(+new Date).toString();if("localStorage"==y||"globalStorage"==y)try{v.jStorage_update=a}catch(b){y=!1}else"userDataBehavior"==y&&(w.setAttribute("jStorage_update",a),w.save("jStorage"));d()}function h(){if(v.jStorage)try{u=s.parse(String(v.jStorage))}catch(a){v.jStorage="{}"}else v.jStorage="{}";x=v.jStorage?String(v.jStorage).length:0,u.__jstorage_meta||(u.__jstorage_meta={}),u.__jstorage_meta.CRC32||(u.__jstorage_meta.CRC32={})}function i(){n();try{v.jStorage=s.stringify(u),w&&(w.setAttribute("jStorage",v.jStorage),w.save("jStorage")),x=v.jStorage?String(v.jStorage).length:0}catch(a){}}function j(a){if("string"!=typeof a&&"number"!=typeof a)throw new TypeError("Key name must be string or numeric");if("__jstorage_meta"==a)throw new TypeError("Reserved key name");return!0}function k(){var a,b,c,d,e=1/0,h=!1,j=[];if(clearTimeout(t),u.__jstorage_meta&&"object"==typeof u.__jstorage_meta.TTL){a=+new Date,c=u.__jstorage_meta.TTL,d=u.__jstorage_meta.CRC32;for(b in c)c.hasOwnProperty(b)&&(c[b]<=a?(delete c[b],delete d[b],delete u[b],h=!0,j.push(b)):c[b]<e&&(e=c[b]));e!=1/0&&(t=setTimeout(k,Math.min(e-a,2147483647))),h&&(i(),g(),f(j,"deleted"))}}function l(){var a,b;if(u.__jstorage_meta.PubSub){var c,d=D,e=[];for(a=b=u.__jstorage_meta.PubSub.length-1;a>=0;a--)c=u.__jstorage_meta.PubSub[a],c[0]>D&&(d=c[0],e.unshift(c));for(a=e.length-1;a>=0;a--)m(e[a][1],e[a][2]);D=d}}function m(a,b){if(C[a])for(var c=0,d=C[a].length;d>c;c++)try{C[a][c](a,s.parse(s.stringify(b)))}catch(e){}}function n(){if(u.__jstorage_meta.PubSub){for(var a=+new Date-2e3,b=0,c=u.__jstorage_meta.PubSub.length;c>b;b++)if(u.__jstorage_meta.PubSub[b][0]<=a){u.__jstorage_meta.PubSub.splice(b,u.__jstorage_meta.PubSub.length-b);break}u.__jstorage_meta.PubSub.length||delete u.__jstorage_meta.PubSub}}function o(a,b){u.__jstorage_meta||(u.__jstorage_meta={}),u.__jstorage_meta.PubSub||(u.__jstorage_meta.PubSub=[]),u.__jstorage_meta.PubSub.unshift([+new Date,a,b]),i(),g()}function p(a,b){for(var c,d=a.length,e=b^d,f=0;d>=4;)c=255&a.charCodeAt(f)|(255&a.charCodeAt(++f))<<8|(255&a.charCodeAt(++f))<<16|(255&a.charCodeAt(++f))<<24,c=1540483477*(65535&c)+((1540483477*(c>>>16)&65535)<<16),c^=c>>>24,c=1540483477*(65535&c)+((1540483477*(c>>>16)&65535)<<16),e=1540483477*(65535&e)+((1540483477*(e>>>16)&65535)<<16)^c,d-=4,++f;switch(d){case 3:e^=(255&a.charCodeAt(f+2))<<16;case 2:e^=(255&a.charCodeAt(f+1))<<8;case 1:e^=255&a.charCodeAt(f),e=1540483477*(65535&e)+((1540483477*(e>>>16)&65535)<<16)}return e^=e>>>13,e=1540483477*(65535&e)+((1540483477*(e>>>16)&65535)<<16),e^=e>>>15,e>>>0}var q="0.4.12",r=window.jQuery||window.$||(window.$={}),s={parse:window.JSON&&(window.JSON.parse||window.JSON.decode)||String.prototype.evalJSON&&function(a){return String(a).evalJSON()}||r.parseJSON||r.evalJSON,stringify:Object.toJSON||window.JSON&&(window.JSON.stringify||window.JSON.encode)||r.toJSON};if("function"!=typeof s.parse||"function"!=typeof s.stringify)throw new Error("No JSON support found, include //cdnjs.cloudflare.com/ajax/libs/json2/20110223/json2.js to page");var t,u={__jstorage_meta:{CRC32:{}}},v={jStorage:"{}"},w=null,x=0,y=!1,z={},A=!1,B=0,C={},D=+new Date,E={isXML:function(a){var b=(a?a.ownerDocument||a:0).documentElement;return b?"HTML"!==b.nodeName:!1},encode:function(a){if(!this.isXML(a))return!1;try{return(new XMLSerializer).serializeToString(a)}catch(b){try{return a.xml}catch(c){}}return!1},decode:function(a){var b,c="DOMParser"in window&&(new DOMParser).parseFromString||window.ActiveXObject&&function(a){var b=new ActiveXObject("Microsoft.XMLDOM");return b.async="false",b.loadXML(a),b};return c?(b=c.call("DOMParser"in window&&new DOMParser||window,a,"text/xml"),this.isXML(b)?b:!1):!1}};r.jStorage={version:q,set:function(a,b,c){if(j(a),c=c||{},"undefined"==typeof b)return this.deleteKey(a),b;if(E.isXML(b))b={_is_xml:!0,xml:E.encode(b)};else{if("function"==typeof b)return void 0;b&&"object"==typeof b&&(b=s.parse(s.stringify(b)))}return u[a]=b,u.__jstorage_meta.CRC32[a]="2."+p(s.stringify(b),2538058380),this.setTTL(a,c.TTL||0),f(a,"updated"),b},get:function(a,b){return j(a),a in u?u[a]&&"object"==typeof u[a]&&u[a]._is_xml?E.decode(u[a].xml):u[a]:"undefined"==typeof b?null:b},deleteKey:function(a){return j(a),a in u?(delete u[a],"object"==typeof u.__jstorage_meta.TTL&&a in u.__jstorage_meta.TTL&&delete u.__jstorage_meta.TTL[a],delete u.__jstorage_meta.CRC32[a],i(),g(),f(a,"deleted"),!0):!1},setTTL:function(a,b){var c=+new Date;return j(a),b=Number(b)||0,a in u?(u.__jstorage_meta.TTL||(u.__jstorage_meta.TTL={}),b>0?u.__jstorage_meta.TTL[a]=c+b:delete u.__jstorage_meta.TTL[a],i(),k(),g(),!0):!1},getTTL:function(a){var b,c=+new Date;return j(a),a in u&&u.__jstorage_meta.TTL&&u.__jstorage_meta.TTL[a]?(b=u.__jstorage_meta.TTL[a]-c,b||0):0},flush:function(){return u={__jstorage_meta:{CRC32:{}}},i(),g(),f(null,"flushed"),!0},storageObj:function(){function a(){}return a.prototype=u,new a},index:function(){var a,b=[];for(a in u)u.hasOwnProperty(a)&&"__jstorage_meta"!=a&&b.push(a);return b},storageSize:function(){return x},currentBackend:function(){return y},storageAvailable:function(){return!!y},listenKeyChange:function(a,b){j(a),z[a]||(z[a]=[]),z[a].push(b)},stopListening:function(a,b){if(j(a),z[a]){if(!b)return void delete z[a];for(var c=z[a].length-1;c>=0;c--)z[a][c]==b&&z[a].splice(c,1)}},subscribe:function(a,b){if(a=(a||"").toString(),!a)throw new TypeError("Channel not defined");C[a]||(C[a]=[]),C[a].push(b)},publish:function(a,b){if(a=(a||"").toString(),!a)throw new TypeError("Channel not defined");o(a,b)},reInit:function(){b()},noConflict:function(a){return delete window.$.jStorage,a&&(window.jStorage=this),this}},a()}();var extend,bind=function(a,b){return function(){return a.apply(b,arguments)}};extend=function(a,b){var c,d;for(d in b)c=b[d],a[d]=c;return a},window.SmartTagInclude=function(a,b){return extend(a.prototype,b)},window.SmartTagClass=function(){function a(){this.reEvaluate=bind(this.reEvaluate,this),this.init_jStorage(),"function"!=typeof window.st&&(window.st=function(){return window.st.commands=window.st.commands||[],window.st.commands.push(arguments)}),window.st.commands=window.st.commands||[],this.debugMode=!1,this.xp_uid=null,this.xp1_org_id=null,this.rocket_fuel_account_id=null,this.events=[],this.startTime=new Date,this.setPreview(),this.host("s.xp1.ru4.com"),this.installHookOnCommandsArray(),this.processPendingCommands(),history.pushState&&this.setupURLChangeListener(),this.log("Current version is "+this.version()),this.logCurrentTime()}return a.prototype.printLog=function(){var a,b,c,d,e;if(null!=this.logMessages){for(d=this.logMessages,e=[],a=0,b=d.length;b>a;a++)c=d[a],e.push(console.log("SmartTag: "+c));return e}},a.prototype.log=function(a){return null==this.logMessages&&(this.logMessages=[]),this.logMessages.push(a),this.debugMode===!0?console.log("SmartTag: "+a):void 0},a.prototype.debug=function(a){return this.debugMode=a,this.debugMode===!0&&this.log("Debug mode enabled."),this.log("The timestamp is "+this.startTime)},a.prototype.status=function(a){return"preview"===a?this.preview=!0:void 0},a.prototype.identify=function(a){return this.log("Origin Org ID is now set to '"+a+"'."),this.xp1_org_id=a,this.jStorage.set("xp1_org_id",a)},a.prototype.version=function(){return"0.9.36"},a.prototype.smarttagid=function(a){return this.log("SmartTag Id is now set to '"+a+"'."),this.smarttag_id=a,this.jStorage.set("smarttag_id",a)},a.prototype.init_jStorage=function(){return"undefined"==typeof window.jQuery?this.jStorage=$.jStorage:this.jStorage=window.jQuery.jStorage},a.prototype.logCurrentTime=function(){var a;return a=new Date,this.log("Now is "+a+", "+(a-this.startTime)+"ms passed from start\n")},a.prototype.optout=function(a,b){return this.opt_out_cookie_name=a,this.opt_out_cookie_value=b},a.prototype.setupURLChangeListener=function(){var a;return this.addEvent("hashchange",this.reEvaluate,window),a=history.pushState,history.pushState=function(b){return function(){var c;return c=a.apply(window.history,arguments),b.reEvaluate(),c}}(this),""},a.prototype.reEvaluate=function(){var a,b,c,d,e,f,g,h,i;for(this.log("Re-evaluate all the conditions"),g=this.events,i=[],c=0,e=g.length;e>c;c++){for(a=g[c],h=a.condition_groups,d=0,f=h.length;f>d;d++)b=h[d],b.clean();a.initState(),i.push(a.run())}return i},a.prototype.setPreview=function(){var a,b,c,d;for(this.preview=this.preview||!1,d=document.location.search.split("&"),a=0,b=d.length;b>a;a++)if(c=d[a],null!=c&&c.indexOf("smarttag_qa=true")>-1){this.preview=!0;break}return this.log("The preview mode is set to "+this.preview+"!")},a.prototype.renameDataLayer=function(a){return a?this.dataLayerName=a:void 0},a}(),window.SmartTagCondition=function(){function a(a,b){this.condition_object=a,this.condition_group=b,this.status=!1,this.listeners=[],this.event=this.condition_group.event,this.smartTag=this.condition_group.smartTag}return a.prototype.evaluate=function(){return this.conditionObjectEvaluation()},a.prototype.triggered=function(){return this.condition_group.groupTriggered()},a.prototype.conditionObjectEvaluation=function(){switch(this.condition_group.name){case"PgDtl":return this.pageDetailsConditionEvaluation();case"OnPgBehavior":return this.onPageBehaviorConditionEvaluation();case"CampaignReferrer":return this.campaignReferrerEvaluation();case"Data":return this.dataConditionEvaluation();case"GTMEvent":return this.googleTagManagerEventEvaluation()}},a.prototype.removeHandler=function(a,b,c){return a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent?a.detachEvent("on"+b,c):a["on"+b]=null},a}(),window.SmartTagInclude(window.SmartTagClass,{getProtocol:function(){return"https:"===document.location.protocol?"https:":"http:"},cachebust:function(){return(Math.random()+"").substr(2)},setOriginAttribute:function(a,b,c){var d,e;return e=new XMLHttpRequest,this.originAPIDomain=this.originAPIDomain||null,this.xp1_org_id=this.xp1_org_id||null,a=a||null,e.open("POST",this.protocol()+"//"+this.originAPIDomain+"/wsb/"+this.xp1_org_id+"/dc/a/"+a,!0),e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.withCredentials=!0,d={PartnerID:this.xp1_org_id,UserAgent:navigator.userAgent,GUID:this.guid,Data:[b,""]},this.mergeObject(d,c),e.onload=function(a){return SmartTag.log("Received response from setOriginAttribute API call:"),SmartTag.log(this.responseText)},e.send("RequestObject="+this.stringify(d))},logOriginActivity:function(a,b){var c,d,e,f,g;for(this.log(this.generateIndent(3)+"Firing Log Origin Activity Pixel "+this.xp1_org_id+" : "+a),c="",e=0,f=b.length;f>e;e++)g=b[e],c+="&"+encodeURIComponent(g.origin_qstring)+"="+encodeURIComponent(g.getValue());return d=function(b){return function(){return b.xp1_org_id=b.xp1_org_id||null,a=a||null,(new Image).src=b.getProtocol()+("//"+b.originAPIDomain+"/activity?_o=")+b.xp1_org_id+"&_t="+a+"&cachebust="+b.cachebust()+c}}(this),window.setTimeout(d,.1)},rocketFuelAPI:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n;for(this.log(this.generateIndent(3)+"Firing RocketFuel pixel: rf_account_id["+a+"], pixid["+b+"]"),n=[],h=0,j=c.length;j>h;h++)f=c[h],null!=f.rf_attribute_name&&""!==f.rf_attribute_name&&(m=f.rf_attribute_name+"="+(f.value||null),n.push(m));if(""!==d)for(i=0,k=e.length;k>i;i++)l=e[i],this.log(this.generateIndent(4)+"Adding Origin custom variables! - appending '&"+encodeURIComponent(l.origin_qstring)+"="+encodeURIComponent(l.getValue())+"'"),n.push("&"+encodeURIComponent(l.origin_qstring)+"="+encodeURIComponent(l.getValue()));return g=function(c){return function(){return null!=a?c._rocketFuelAPIWithAccoundId(a,b,d,n):c._rocketFuelAPIWithoutAccoundId(b,d,n)}}(this),window.setTimeout(g,.1)},_rocketFuelAPIWithAccoundId:function(a,b,c,d){var e;return b=b||null,e=this.getProtocol()+("//"+b+"p.rfihub.com/ca.html?rb="+a+"&ca="+b+"&ra=")+this.cachebust()+"&t=home"+this.generateOriginParams(c)+("&"+d.join("&")),this.insertIframe(e)},_rocketFuelAPIWithoutAccoundId:function(a,b,c){var d;return a=a||null,d=this.getProtocol()+("//"+a+"p.rfihub.com/ca.html?ca="+a+"&ra=")+this.cachebust()+"&t=home"+this.generateOriginParams(b)+("&"+c.join("&")),this.insertIframe(d)},generateOriginParams:function(a){return""!==a?(this.log(this.generateIndent(4)+"Detected Origin params! - appending '&_o="+this.xp1_org_id+"&_t="+a+"'"),"&_o="+this.xp1_org_id+"&_t="+a):""},insertIframe:function(a){var b,c;return c=document.createElement("iframe"),c.setAttribute("border",0),c.setAttribute("frameborder",0),c.setAttribute("vspace",0),c.setAttribute("hspace",0),c.setAttribute("scrolling","no"),c.setAttribute("marginheight",0),c.setAttribute("marginwidth",0),c.setAttribute("style","display:none;padding:0;margin:0"),c.setAttribute("width",0),c.setAttribute("height",0),c.src=a,b=document.getElementsByTagName("script")[0],b.parentNode.insertBefore(c,b),this.log("iFrame inserted")}}),window.SmartTagInclude(window.SmartTagClass,{installHookOnCommandsArray:function(){return this.log("Installing hook on commands array"),window.st.commands.push=function(){var a,b,c,d;for(d=[],b=0,c=arguments.length;c>b;b++)a=arguments[b],d.push(window.SmartTag.processCommand(a));return d}},processPendingCommands:function(){var a,b;for(this.log("Processing "+window.st.commands.length+" command(s) that are pending"),b=[];a=window.st.commands.shift();)b.push(this.processCommand(a));return b},processCommand:function(args){var argumentsArray,error,theFunction;argumentsArray=[].slice.call(args),theFunction=eval("this."+argumentsArray[0]);try{return theFunction.apply(this,argumentsArray.slice(1))}catch(_error){return error=_error,this.log("Error processing command "+argumentsArray[0]+": "+error)}}}),window.SmartTagInclude(window.SmartTagClass,{convert2BooleanValue:function(a){switch(a){case"t":return!0;case"f":return!1;default:return null}},generateIndent:function(a){var b,c;for(null==a&&(a=1),c="",b=0;a>b;)c+=" ",++b;return c},mergeObject:function(a,b){var c;for(c in b)a[c]=b[c];return a},addEvent:function(a,b,c){return c.addEventListener?c.addEventListener(a,b):c.attachEvent?c.attachEvent("on"+a,b):void 0}}),window.SmartTagInclude(window.SmartTagClass,{createCookie:function(a,b,c){var d,e,f;return c?(e=new Date,e.setTime(e.getTime()+24*c*60*60*1e3),f="; expires="+e.toGMTString()):f="",d=a+"="+b+f+"; path=/",this.log("Creating cookie "+d),document.cookie=d},readCookie:function(a){var b,c,d,e,f,g,h;for(f=a+"=",h=null,c=function(a){for(;" "===a.charAt(0);)a=a.substring(1,a.length);return 0===a.indexOf(f)?h=a.substring(f.length,a.length):void 0},g=document.cookie.split(";"),d=0,e=g.length;e>d;d++)b=g[d],c(b);return this.log("Read cookie "+a+": "+h),h},eraseCookie:function(a){return this.createCookie(a,"",-1)},checkCookie:function(){var a;return a=navigator.cookieEnabled?!0:!1,"undefined"!=typeof navigator.cookieEnabled||a||(document.cookie="testcookie",a=-1!==document.cookie.indexOf("testcookie")?!0:!1),a}}),window.SmartTagInclude(window.SmartTagClass,{deviceType:function(){return this.isTablet()?"tablet":this.isMobile()?"mobile":"desktop"},userAgent:function(){return navigator.userAgent||navigator.vendor||window.opera},isMobile:function(){return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge|maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm(os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows(ce|phone)|xda|xiino/i.test(this.userAgent())||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(this.userAgent().substr(0,4))},isTablet:function(){return/iPad/.test(this.userAgent())||this.isMobile()&&document.width>1008}}),window.SmartTagInclude(window.SmartTagCondition,{campaignReferrerEvaluation:function(){switch(this.condition_object.attr){case"campaign":return this.campaign_event();case"referrer":return this.referrer_event()}},campaign_event:function(){var a,b,c,d,e,f;for(e=document.location.search.split("&"),f=[],a=0,b=e.length;b>a;a++)d=e[a],c=d.match(/(utm_source|cid)=(.*)/),null!=c&&c[2]===this.condition_object.value?(this.triggered(),f.push(this.smartTag.log("Campain is triggered"))):f.push(void 0);return f},referrer_event:function(){return document.referrer.indexOf(this.condition_object.value)>=0?(this.smartTag.log("referrer is matched!"),this.triggered()):void 0}}),window.SmartTagConditionGroup=function(){function a(a,b){this.name=a,this.event=b,this.status=!1,this.conditions=[],this.smartTag=this.event.smartTag}return a.prototype.push=function(a){return this.conditions.push(a)},a.prototype.groupTriggered=function(){return this.smartTag.log('The condition "'+this.name+'" of the event '+this.event.id+" is triggered"),this.status=!0,this.event.evaluate(),this.event.multi_trigger?void 0:this.clean()},a.prototype.clean=function(){var a,b,c,d,e;for(d=this.conditions,e=[],b=0,c=d.length;c>b;b++)a=d[b],a.removeListeners(),e.push(a.removeDataLayerPushHook());return e},a}(),window.SmartTagCustomVariable=function(){function SmartTagCustomVariable(a,b){this.event=b,this.id=a.id,this.name=a.name,this.variable_type=a.variable_type,this.variable_name=a.variable_name,this.origin_qstring=a.origin_qstring,this.rf_attribute_name=a.rf_attribute_name,this.value_type=a.value_type||"string"}return SmartTagCustomVariable.prototype.toData=function(){return{id:this.id,name:this.name,value:this.getValue()||"",origin_qstring:this.origin_qstring,rf_attribute_name:this.rf_attribute_name}},SmartTagCustomVariable.prototype.getValue=function(){var cookieHash,e,queryHash,value;return value=function(){try{switch(this.variable_type){case"javascript_custom_variable":return""!==this.variable_name?eval(this.variable_name):"";case"dom":return""!==this.variable_name?document.getElementById(this.variable_name).innerHTML:"";case"cookie":return cookieHash=this.cookieToHash(),""!==this.variable_name?cookieHash[this.variable_name]:"";case"query_string":return queryHash=this.searchToHash(),""!==this.variable_name?queryHash[this.variable_name]:""}}catch(_error){return e=_error,""}}.call(this),this.toValueType(value)||null},SmartTagCustomVariable.prototype.toApiParams=function(){var a;return a={},a[""+this.origin_qstring]=this.getValue(),a},SmartTagCustomVariable.prototype.cookieToHash=function(){var a,b,c,d,e,f;for(f={},e=document.cookie.split(";"),b=0,c=e.length;c>b;b++)a=e[b],d=a.match(/(.*)=(.*)/),d&&(f[d[1].trim()]=d[2]);return f},SmartTagCustomVariable.prototype.searchToHash=function(){var a,b,c,d,e,f;for(e={},d=document.location.search.split("&"),a=0,b=d.length;b>a;a++)f=d[a],c=f.match(/\??(.*?)=(.*)/),c&&(e[c[1]]=c[2]);return e},SmartTagCustomVariable.prototype.toValueType=function(a){var b,c,d;return d=function(){try{switch(this.value_type){case"number":return c=a.match(/\d+/),c.length>0?parseInt(c[0]):"";case"number_with_decimal":return c=a.match(/\d+\.\d+/),c.length>0?parseFloat(c[0]):"";default:return a}}catch(d){return b=d,null}}.call(this)},SmartTagCustomVariable}(),window.SmartTagInclude(window.SmartTagCondition,{dataConditionEvaluation:function(){switch(this.condition_object.attr){case"dfp":return this.DFPZoneEvaluation();case"js_var":return this.jsVarEvaluation();case"audience":return this.audienceEvaluation();case"cookie":return this.cookieEvaluation()}},DFPZoneEvaluation:function(){var a,b,c,d,e;if("undefined"!=typeof googletag){a=[],d=googletag.slot_manager_instance.a;for(b in d)e=d[b],c=b.match(/\/\d+\/(.*)/),null!=c&&(a=a.concat(c[1].split("/")));switch(this.condition_object.matcher){case"contains":if(a.indexOf(this.condition_object.value)>-1)return this.triggered();break;case"does_not_contain":if(-1===a.indexOf(this.condition_object.value))return this.triggered();break;case"is":if(1===a.length&&a[0]===this.condition_object.value)return this.triggered()}}},jsVarEvaluation:function(){var error,jsVarValue;if(null!=this.condition_object.attr_name)try{switch(jsVarValue=eval(this.condition_object.attr_name),this.condition_object.matcher){case"contains":if(jsVarValue.indexOf(this.condition_object.value)>-1)return this.triggered();break;case"does_not_contain":if(-1===jsVarValue.indexOf(this.condition_object.value))return this.triggered();break;case"is":if(jsVarValue===this.condition_object.value)return this.triggered();break;case"greater_than":if(parseFloat(jsVarValue)>parseFloat(this.condition_object.value))return this.triggered();break;case"less_than":if(parseFloat(jsVarValue)<parseFloat(this.condition_object.value))return this.triggered()}}catch(_error){return error=_error,this.smartTag.log(error)}},cookieEvaluation:function(){return null!=this.condition_object.value&&document.cookie.indexOf(this.condition_object.value)>-1?this.triggered():void 0},audienceEvaluation:function(){var a;return a={GUID:this.smartTag.guid,Data:{"":""}},this.smartTag.jsonpGet(this.smartTag.getProtocol()+"//"+this.smartTag.originAPIDomain+"/wsb/"+this.smartTag.xp1_org_id+"/poe/"+this.smartTag.xp1_org_id,{RequestObject:JSON.stringify(a)},this.audienceCallback,this,"callback")},audienceCallback:function(a){var b;if("1"===a.ResponseCode)return b=a.Nodes,b.indexOf(this.condition_object.value)>-1?this.triggered():void 0}}),window.SmartTagEvent=function(){function a(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;this.smartTag=b,this.id=a.id,this.name=a.name,this.condition_groups=[],this.origin_cust_vars=[],this.primary_condition=new window.SmartTagPrimaryCondition(a,this,this.smartTag)||{},this.triggered=!1,this.activated=!1,this.called_api=!1,this.multi_trigger="t"===a.multi_trigger?!0:!1,this.rf_cust_vars=[],this.origin_attribute_id=a.origin_attribute_id,this.origin_attribute_value=a.origin_attribute_value,this.origin_act_tag_map=a.origin_act_tag_map,this.rf_pixid=a.rf_pixid,this.status=a.status,o=a.conditions;for(e in o)for(g=o[e],d=this.findOrCreateConditionGroup(e),i=0,l=g.length;l>i;i++)f=g[i],c=new window.SmartTagCondition(f,d),d.push(c);if(null!=a.origin_cust_vars)for(p=a.origin_cust_vars,j=0,m=p.length;m>j;j++)h=p[j],this.origin_cust_vars.push(new window.SmartTagCustomVariable(h,this));if(null!=a.rf_cust_vars)for(q=a.rf_cust_vars,k=0,n=q.length;n>k;k++)h=q[k],this.rf_cust_vars.push(new window.SmartTagCustomVariable(h,this))}return a.prototype.findOrCreateConditionGroup=function(a){var b,c,d,e,f;for(e=this.condition_groups,c=0,d=e.length;d>c;c++)b=e[c],b.name===a&&(f=b);return null==f&&(f=new window.SmartTagConditionGroup(a,this)),this.condition_groups.push(f),f},a.prototype.callAPI=function(){return this.called_api?void 0:(""!==this.origin_attribute_id&&this.smartTag.setOriginAttribute(this.origin_attribute_id,this.origin_attribute_value,this.normalizeOriginCustomVariables()),""!==this.origin_act_tag_map&&this.smartTag.logOriginActivity(this.origin_act_tag_map,this.origin_cust_vars),""!==this.rf_pixid&&this.smartTag.rocketFuelAPI(this.smartTag.rf_acct_id,this.rf_pixid,this.normalizeRocketFuelCustomVariables(),this.origin_act_tag_map,this.origin_cust_vars),this.called_api=!0)},a.prototype.evaluate=function(){var a,b,c,d,e;if(this.evaluateAllConditions()){for(e=this.condition_groups,c=0,d=e.length;d>c;c++)a=e[c],this.multi_trigger||a.clean();return b=[],this.triggered||(this.smartTag.saveActivation({event_id:this.id,origin_cust_vars:this.normalizeOriginCustomVariables(),pixid:this.rf_pixid}),this.multi_trigger||(this.triggered=!0)),this.primary_condition.evaluate()?(this.smartTag.log(this.smartTag.generateIndent(2)+"Event "+this.id+' "'+this.name+'" is activated '),this.smartTag.saveActivation({event_id:this.id,origin_cust_vars:this.normalizeOriginCustomVariables(),pixid:this.rf_pixid,activated:!0}),this.callAPI()):this.smartTag.log(this.smartTag.generateIndent(2)+"Event "+this.id+' "'+this.name+'" is triggered not activated'),this.smartTag.logCurrentTime()}},a.prototype.evaluateAllConditions=function(){var a,b,c,d,e;for(this.smartTag.log("Evaluating all the conditions of event "+this.id+' "'+this.name+'"...'),e=!0,d=this.condition_groups,b=0,c=d.length;c>b;b++)a=d[b],this.smartTag.log(this.smartTag.generateIndent(1)+"Condition group "+a.name+" is "+a.status+"!"),e=e&&a.status;return e},a.prototype.initState=function(){return this.triggered=!1,this.activated=!1,this.called_api=!1},a.prototype.run=function(){var a,b,c,d,e,f,g,h;for(this.smartTag.log("Start to eval all the conditions of the event "+this.id+' "'+this.name+'"....'),g=this.condition_groups,c=0,e=g.length;e>c;c++)for(b=g[c],h=b.conditions,d=0,f=h.length;f>d;d++)a=h[d],a.evaluate();return this.evaluate()},a.prototype.normalizeOriginCustomVariables=function(){var a,b,c,d,e;for(a={},e=this.origin_cust_vars,b=0,c=e.length;c>b;b++)d=e[b],this.smartTag.mergeObject(a,d.toApiParams());return a},a.prototype.normalizeRocketFuelCustomVariables=function(){var a,b,c,d,e;for(e=[],d=this.rf_cust_vars,b=0,c=d.length;c>b;b++)a=d[b],e.push(a.toData());return e},a.prototype.storagedActivations=function(){var a;return null!=this.smartTag.jStorage.get("activations")&&(a=this.smartTag.jStorage.get("activations")[this.id]),a||[]},a.prototype.hasBeenTriggered=function(){var a,b,c,d;for(d=this.storagedActivations(),b=0,c=d.length;c>b;b++)if(a=d[b],a.activated)return!0;return!1},a}(),window.SmartTagInclude(window.SmartTagCondition,{googleTagManagerEventEvaluation:function(){var a,b,c,d;if(this.dataLayer=this.dataLayer||window[this.dataLayerName()],this.matcher=this.condition_object.matcher,this.event_name=this.condition_object.value,this.dataLayer){for(this.stored_events=this.dataLayer||[],d=this.stored_events,b=0,c=d.length;c>b;b++)if(a=d[b],a.event===this.event_name)return void this.triggered();return this.setupDataLayerPushHook()}},setupDataLayerPushHook:function(){return this.orig_push=this.dataLayer.push,this.dataLayer.push=function(a){return function(){var b;return b=arguments[0],b&&b.event&&b.event===a.event_name&&a.triggered(),a.orig_push.apply(a.dataLayer,arguments)}}(this)},removeDataLayerPushHook:function(){return this.dataLayer&&this.orig_push?this.dataLayer.push=this.orig_push:void 0},dataLayerName:function(){return this.smartTag.dataLayerName||"dataLayer"}}),window.SmartTagInclude(window.SmartTagCondition,{onPageBehaviorConditionEvaluation:function(){switch(this.condition_object.attr){case"click":return this.click_event();case"link_click":return this.link_click_event();case"hover":return this.hover_event();case"submit":return this.submit_event();case"scroll":return this.scroll_event();case"timer":return this.timer_event()}},click_event:function(){var a,b,c,d,e,f;switch(a=function(a){return function(b){return a.triggered()}}(this),this.condition_object.matcher){case"element_with_id":if(d=document.getElementById(this.condition_object.value),null!=d)return this.addEvent("click",a,d),this.listeners.push({obj:d,event:"click",added_event:a});break;case"element_with_class":for(e=document.getElementsByClassName(this.condition_object.value),f=[],b=0,c=e.length;c>b;b++)d=e[b],this.addEvent("click",a,d),f.push(this.listeners.push({obj:d,event:"click",added_event:a}));return f}},link_click_event:function(){var a,b,c,d,e,f,g,h,i,j;switch(a=function(a){return function(b){return a.smartTag.log("link click event is triggered"),a.triggered()}}(this),this.condition_object.matcher){case"link_with_text_contains":for(g=document.getElementsByTagName("a"),i=[],b=0,d=g.length;d>b;b++)f=g[b],f.text.indexOf(this.condition_object.value)>=0?(this.addEvent("click",a,f),i.push(this.listeners.push({obj:f,event:"click",added_event:a}))):i.push(void 0);return i;case"link_with_target_url_is":for(h=document.getElementsByTagName("a"),j=[],c=0,e=h.length;e>c;c++)f=h[c],f.href.indexOf(this.condition_object.value)>=0?(this.addEvent("click",a,f),j.push(this.listeners.push({obj:f,event:"click",added_event:a}))):j.push(void 0);return j}},hover_event:function(){var a,b;return this.hover_can_be_triggered=!0,b=document.getElementById(this.condition_object.value),null!=b?(a=function(a){return function(){return a.hover_can_be_triggered?(a.triggered(),a.hover_can_be_triggered=!1,setTimeout(function(){return a.hover_can_be_triggered=!0},2e3)):void 0}}(this),this.addEvent("mouseover",a,b),this.listeners.push({obj:b,event:"mouseover",added_event:a})):void 0},submit_event:function(){var a,b,c,d,e,f;for(e=document.getElementsByTagName("form"),f=[],b=0,c=e.length;c>b;b++)d=e[b],d.id===this.condition_object.value?(a=function(a){return function(){return a.triggered()}}(this),this.addEvent("submit",a,d),f.push(this.listeners.push({obj:d,event:"submit",added_event:a}))):f.push(void 0);return f},scroll_event:function(){var a;return this.scroll_can_be_triggered=!0,a=function(a){return function(){var b;return a.scroll_can_be_triggered?(b=document.body.scrollTop/(document.body.scrollHeight-document.documentElement.clientHeight)*100,b>=parseInt(a.condition_object.value)&&a.triggered(),a.scroll_can_be_triggered=!1,setTimeout(function(){return a.scroll_can_be_triggered=!0},1e3)):void 0}}(this),this.addEvent("scroll",a,document),this.listeners.push({obj:document,event:"scroll",added_event:a})},timer_event:function(){var a,b;switch(b=this.condition_object.value.split(" "),this.delayed_time=this.convert_time_to_million_second(b[0],b[1]),this.condition_object.matcher){case"page":return a=function(a){return function(){return a.triggered()}}(this),window.setTimeout(a,this.delayed_time);case"session":return a=function(a){return function(){var b;return b=new Date-a.smartTag.session.start_time,b>=a.delayed_time?(a.triggered(),a.clearConditionInverval()):void 0}}(this),this.intervalID=window.setInterval(a,1e3)}},convert_time_to_million_second:function(a,b){var c;return c=function(){switch(b){case"seconds":return 1e3*parseInt(a);case"minutes":return 1e3*parseInt(a)*60;case"hours":return 1e3*parseInt(a)*60*60}}()},clearConditionInverval:function(){return window.clearInterval(this.intervalID)},addEvent:function(a,b,c){return this.condition_group.event.smartTag.addEvent(a,b,c)},removeListeners:function(){var a,b,c,d,e;for(d=this.listeners,e=[],a=0,b=d.length;b>a;a++)c=d[a],e.push(this.removeHandler(c.obj,c.event,c.added_event));return e}}),window.SmartTagInclude(window.SmartTagCondition,{pageDetailsConditionEvaluation:function(){var a,b,c;return a=function(){switch(this.condition_object.attr){case"page_title":return document.title;case"url":return document.URL.replace(/^https?:\/\//,"")}}.call(this),c=this.condition_object.value,"true"===this.condition_object.case_insensitive&&(a=a.toLowerCase(),c=c.toLowerCase()),b=function(){switch(this.condition_object.matcher){case"contains":return a.indexOf(c)>=0;case"begins_with":return 0===a.indexOf(c);case"does_not_contain":return a.indexOf(c)<0;case"is_exactly":return a===c;case"matches_regex":return null!==a.match(c)}}.call(this),b?this.triggered():void 0}}),window.SmartTagPrimaryCondition=function(){function a(a,b,c){this.event=b,this.smartTag=c,this.scope_attr=a.scope_attr,this.event_id=this.event.id,this.scope_value=parseInt(a.scope_value,10),this.scope_rec_type=a.scope_rec_type,this.scope_rec_val=parseInt(a.scope_rec_val,10),this.scope=a.scope,this.activations=this.getActivationsByEventId()}return a.prototype.getActivationsByEventId=function(){var a;try{return this.smartTag.jStorage.get("activations")[this.event_id.toString()]||[]}catch(b){return a=b,[]}},a.prototype.evaluate=function(){switch(this.smartTag.log(this.smartTag.generateIndent(1)+"Evaluating primary condition of the event "+this.event_id+' "'+this.event.name+'"...'),this.scope){case"visits":return this.evaluateForVisitor();case"views":return this.currentSessionActivationCount()>=this.scope_value;case"all_pages":return!0}},a.prototype.currentSessionActivationCount=function(){var a,b,c,d,e;for(b=0,e=this.activations,c=0,d=e.length;d>c;c++)a=e[c],(a.session_id=this.smartTag.session.sessionId)&&(b+=1);return b},a.prototype.evaluateForVisitor=function(){switch(this.scope_attr){case"times":return this.evaluateVisitCount();case"pages":return this.evaluatePageviewCount()}},a.prototype.evaluateVisitCount=function(){var a;return a=function(){switch(this.scope_rec_type){case"all_time":return this.getSessionCount(this.activations)>=this.scope_value;case"in":return this.getSessionCount(this.activationCountInNDays(this.scope_rec_val))>=this.scope_value}}.call(this)},a.prototype.evaluatePageviewCount=function(){var a;return a=function(){switch(this.scope_rec_type){case"all_time":return this.activations.length>=this.scope_value;case"in":return this.activationCountInNDays(this.scope_rec_val).length>=this.scope_value}}.call(this)},a.prototype.getSessionCount=function(a){var b,c,d,e;for(e=[],c=0,d=a.length;d>c;c++)b=a[c],e.indexOf(b.session_id)<0&&e.push(b.session_id);return e.length},a.prototype.activationCountInNDays=function(a){var b,c,d,e,f,g;for(g=(new Date).getTime()-864e5*a,e=[],f=this.activations,c=0,d=f.length;d>c;c++)b=f[c],Date.parse(b.timestamp)>=g&&e.push(b);return e},a}(),window.SmartTagInclude(window.SmartTagClass,{getEvents:function(){var a;return a=this.jStorage.get("events"),null!=a?(this.used_cache=!0,this.log("Using events cache!"),this.eventsLoaded(a)):(this.used_cache=!1,this.log("Not using events cache!"),this.jsonpGet("/smarttagevent",this.normalizeParams(),this.eventsLoaded))},eventsLoaded:function(a){var b,c,d,e,f;if(a.status&&"failed"===a.status)return this.log("Error loading events:"),this.log(a.message);for(this.debugMode===!0&&console.log(a),null!=a.rf_acct_id&&(this.rf_acct_id=a.rf_acct_id,this.log("RocketFuel account id now set to: "+this.rf_acct_id)),this.log("Save events into the local storage cache.."),this.jStorage.set("events",a,{TTL:this.cacheDuration()}),this.log("Events saved!"),this.events=this.events||[],e=a.events,c=0,d=e.length;d>c;c++)b=e[c],f=new window.SmartTagEvent(b,this),this.canBeLoaded(f)&&this.events.push(f);return this.evalEvents()},normalizeParams:function(){return{_o:this.xp1_org_id,_t:this.smarttag_id}},cacheDuration:function(){return 6e5},canBeLoaded:function(a){return(a.multi_trigger||!a.hasBeenTriggered())&&(this.preview||"LIVE"===a.status)},evalEvents:function(){var a,b,c,d,e;for(d=this.events,e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(a.run());return e}}),window.SmartTagInclude(window.SmartTagClass,{createGUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b,c;return b=16*Math.random()|0,c="x"===a?b:3&b|8,c.toString(16)})}}),window.SmartTagInclude(window.SmartTagClass,{testMode:function(){return"file:"===document.location.protocol},protocol:function(){return this.testMode()?"http:":document.location.protocol},originDomain:function(){return this.testMode()?"localhost:4567":this.originAPIDomain},host:function(a){return this.log("Set origin api host to '"+a+"'"),this.originAPIDomain=a},jsonpGet:function(a,b,c,d,e){var f,g,h,i,j,k,l,m;null==d&&(d=null),null==e&&(e="_callback"),null==this.jsonpRequests&&(this.jsonpRequests=0),null==this.jsonpCallbacks&&(this.jsonpCallbacks={}),null==arguments[2]&&(c=arguments[1],b={}),this.log("JSONP Get with URI "+a),l=a.match(/^http/)?a:this.protocol()+"//"+this.originDomain()+a,l+=l.indexOf("?")+1?"&":"?",g=document.getElementsByTagName("head")[0],k=document.createElement("script"),j=this.jsonpRequests,this.jsonpRequests++,b[""+e]="window.SmartTag.jsonpCallbacks.request_"+j,this.jsonpCallbacks["request_"+j]=function(a){return g.removeChild(k),null!=d?c.apply(d,[a]):c.apply(window.SmartTag,[a]),delete window.SmartTag.jsonpCallbacks["request_"+j]},i=[],f=function(a){return i.push(a+"="+encodeURIComponent(m+""))};for(h in b)m=b[h],f(h);return l+=i.join("&"),this.log("Complete URL with params"),this.log(l),k.type="text/javascript",k.src=l,g.appendChild(k)}}),window.SmartTagInclude(window.SmartTagClass,{launch:function(){return this.log("Launching..."),this.checkCookie()&&!this.isOptOut()?(this.session=this.registerSession(),this.state=new window.SmartTagState(this),this.guid=this.state.guid,this.log("GUID: "+this.guid),this.state.registerSession(this.session),this.state.save(),this.getEvents(),!0):this.log(this.checkCookie()?"The opt-out mode is enabled!":"Cookie is disabled!")},isOptOut:function(){return(null===this.opt_out_cookie_name||"undefined"==typeof this.opt_out_cookie_name)&&(this.opt_out_cookie_name="opt-out"),(null===this.opt_out_cookie_value||"undefined"==typeof this.opt_out_cookie_value)&&(this.opt_out_cookie_value="true"),this.readCookie(this.opt_out_cookie_name)===this.opt_out_cookie_value}}),window.SmartTagInclude(window.SmartTagClass,{saveActivationToLocalStorage:function(a){var b;return b=a.event_id,null==this.activations&&(this.activations=this.loadActivationsFromLocalStorage()),null!=this.activations[b.toString()]?this.activations[b.toString()].push(a):this.activations[b.toString()]=[a],this.jStorage.set("activations",this.activations)},loadActivationsFromLocalStorage:function(){return this.activations=null!=this.jStorage.get("activations")?this.jStorage.get("activations"):{}},saveActivation:function(a){var b;return b={event_id:a.event_id,session_id:this.session.sessionId,guid:this.guid,device_type:this.deviceType(),custom_variables:a.origin_custom_variables,timestamp:(new Date).toString(),triggered:a.triggered},this.saveActivationToLocalStorage(b)}}),window.SmartTagInclude(window.SmartTagClass,{registerSession:function(){var a,b;return a=this.readCookie(this.sessionCookieName()),null!=a?(this.log("Session already opened, new page view."),b=new window.SmartTagSession(a,this)):(this.log("Initializing new session."),b=new window.SmartTagSession(void 0,this)),b.save(),b}}),window.SmartTagInclude(window.SmartTagClass,{stringify:function(a){return this._stringify(a,0)},_stringify:function(a,b){var c,d,e,f,g,h,i,j;try{if(this.recursion_depth()<b)throw"recursion too deep";if(i=typeof a,"object"!==i||null===a)return"string"===i&&(a='"'+a.replace(/\"/g,'\\"')+'"'),String(a);f=[],c=a&&a.constructor===Array,h=this,e=function(a){if(i=typeof j,"string"===i)j='"'+j.replace(/\"/g,'\\"')+'"';else if("object"===i&&null!==j&&(j=h._stringify(j,b+1),!j))throw"";return f.push(c?String(j):'"'+a+'":'+String(j))};for(g in a)j=a[g],e(g);return c?"["+String(f)+"]":"{"+String(f)+"}"}catch(k){return d=k,""!==d&&this.log("get error "+d+" when serialization"),null}},recursion_depth:function(){return 20},destringify:function(string){return eval("var object = "+string+";"),object}}),window.SmartTagSession=function(){function a(a,b){void 0===window.SmartTag&&void 0!==b?this.smartTag=b:this.smartTag=window.SmartTag,null!=a?this.parseCookieData(a):(this.sessionId=this.smartTag.createGUID(),this.start_time=new Date)}return a.prototype.splitCharacter=function(){return"!!"},a.prototype.parseCookieData=function(a){var b;return a.indexOf("%%")>=0&&(a=a.replace(/%%/g,this.splitCharacter())),b=a.split(this.splitCharacter()),this.sessionId=b[0],null!=b[1]?this.start_time=new Date(parseInt(b[1])):this.start_time=new Date},a.prototype.cookieData=function(){return[this.sessionId,this.start_time.getTime()].join(this.splitCharacter())},a.prototype.save=function(){return this.smartTag.createCookie(this.smartTag.sessionCookieName(),this.cookieData())},a}(),window.SmartTagInclude(window.SmartTagClass,{sessionCookieName:function(){return"st_session"}}),window.SmartTagState=function(){function a(a){var b;void 0===window.SmartTag&&null!=a?this.smartTag=a:this.smartTag=window.SmartTag,b=this.smartTag.readCookie(this.smartTag.stateCookieName()),null!=b?this.parseCookieData(b):(this.guid=this.smartTag.createGUID(),this.sessions=[])}return a.prototype.splitCharacter=function(){return"@@"},a.prototype.splitSessionCharacter=function(){return"$$"},a.prototype.registerSession=function(a){var b,c,d,e,f,g,h;for(this.smartTag.log("Registering session "+a.sessionId+" in state..."),h=!1,e=[],f=this.sessions,b=function(b){return function(c){return c.sessionId===a.sessionId?(b.smartTag.log("Updating session!"),e.push(a),h=!0):e.push(c)}}(this),c=0,d=f.length;d>c;c++)g=f[c],b(g);return h||(e.push(a),this.smartTag.log("Adding new session!")),this.sessions=e},a.prototype.totalSessionsCount=function(){return this.sessions.length},a.prototype.parseCookieData=function(a){var b,c,d,e,f,g,h;for(b=a.split(this.splitCharacter()),this.guid=b[0],h=b[1].split(this.splitSessionCharacter()),g=[],c=function(a){return function(b){return g.push(new window.SmartTagSession(b,a.smartTag))}}(this),d=0,e=h.length;e>d;d++)f=h[d],c(f);return this.sessions=g},a.prototype.cookieData=function(){var a,b,c,d,e,f;for(f=[],d=this.sessions,a=function(a){return f.push(a.cookieData())},b=0,c=d.length;c>b;b++)e=d[b],a(e);return[this.guid,f.join(this.splitSessionCharacter())].join(this.splitCharacter())},a.prototype.save=function(){return this.smartTag.createCookie(this.smartTag.stateCookieName(),this.cookieData(),this.smartTag.stateCookieExpiration())},a}(),window.SmartTagInclude(window.SmartTagClass,{stateCookieName:function(){return"st_state"},stateCookieExpiration:function(){return 3650}}),"object"==typeof window.SmartTag||(window.SmartTag=new window.SmartTagClass);